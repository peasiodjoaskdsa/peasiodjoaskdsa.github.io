<!DOCTYPE html>
<html>
<head>
    <title>OpenAI API Demo</title>
</head>
<body>
    <button id="runButton">Run OpenAI API</button>
    <div id="responseContainer"></div>
    
    <script>
        document.getElementById('runButton').addEventListener('click', function() {
            fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer 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'
                },
                body: JSON.stringify({
                    'model': 'gpt-3.5-turbo',
                    'messages': [
                        {
                            'role': 'user',
                            'content': 'Ret denne tekst her: hej med deg hvem er du min far er meget sÃ¸der'
                        }
                    ],
                    'temperature': 0.7
                })
            })
            .then(response => response.json())
            .then(data => {
                const responseText = data.choices[0].message.content;
                document.getElementById('responseContainer').innerText = responseText;

                // Store the corrected text in a variable
                const correctedText = responseText;

                // Call the function to replace the Outlook mail text
                replaceOutlookMailText(correctedText);
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });

        // Function to replace Outlook mail text
        function replaceOutlookMailText(text) {
            Office.context.mailbox.item.body.setAsync(
                text,
                {
                    coercionType: "html", // Write text as HTML
                },
                function (asyncResult) {
                    if (asyncResult.status == Office.AsyncResultStatus.Failed) {
                        write(asyncResult.error.message);
                    }
                }
            );
        }
    </script>
</body>
</html>
